# DO NOT EDIT THIS FILE
# 8d1619cd-2839-4920-a493-2541e8392b80
name: Setup private key, certificate and access tokens

inputs:
  anio-pkey:
    required: true
  anio-cert:
    required: true
  anio-registry-token:
    required: true
  npm-token:
    required: true

runs:
  using: "composite"
  steps:
    # Place private key and certificate in order to have
    # access to npm-registry.anio.software
    - name: "Setup runner private key and certificate"
      shell: bash
      run: |
        mkdir ./secrets/
        chmod 0700 ./secrets/

        touch ./secrets/npm_client.pkey
        touch ./secrets/npm_client.cert
        touch ./secrets/anio_npm_auth_token
        touch ./secrets/npm_auth_token

        chmod 0600 ./secrets/npm_client.pkey
        chmod 0600 ./secrets/npm_client.cert
        chmod 0600 ./secrets/anio_npm_auth_token
        chmod 0600 ./secrets/npm_auth_token

        printf "%s" "${{ inputs.anio-pkey }}" > ./secrets/npm_client.pkey
        printf "%s" "${{ inputs.anio-cert }}" > ./secrets/npm_client.cert
        printf "%s" "${{ inputs.anio-registry-token }}" > ./secrets/anio_npm_auth_token
        printf "%s" "${{ inputs.npm-token }}" > ./secrets/npm_auth_token

        openssl x509 -in ./secrets/npm_client.cert -noout -text

        ls -la ./secrets/
